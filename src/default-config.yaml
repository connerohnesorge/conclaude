# Conclaude Configuration Template
#
# This is a minimal example configuration file.
# For full documentation of all options, run: conclaude config --docs
# Or see the generated documentation from `cargo doc --open`

# Stop hook - runs when Claude is about to stop
stop:
  commands: []
  # Example:
  # - run: "npm test"
  #   showStdout: true
  #   showStderr: true
  #   showCommand: true  # Show "Executing command X/Y: npm test" (default: true)
  #   message: "Tests failed"
  #   maxOutputLines: 100
  #   timeout: 300

  infinite: false
  infiniteMessage: "continue working on the task"

# Subagent stop hook - runs when subagents finish
subagentStop:
  commands: {}
  # Example:
  # coder:
  #   - run: "npm run lint"
  #     showStdout: true
  #     showCommand: true  # Show "Executing command X/Y: npm run lint" (default: true)
  #     message: "Linting failed"
  # test*:
  #   - run: "npm test"
  #     showStderr: true
  #     showCommand: false  # Hide the "Executing command..." line

# Pre-tool-use hook - file protection and tool validation
preToolUse:
  # Prevent files at repository root
  preventRootAdditions: true
  # Custom message for root additions block (supports {file_path} and {tool} placeholders)
  # Example: "Files must go in src/. Cannot create {file_path} using {tool}."
  preventRootAdditionsMessage: null

  # Protected files (glob patterns)
  uneditableFiles:
    - ".conclaude.yml"
    - ".conclaude.yaml"
  # Examples:
  # - "*.lock"
  # - pattern: ".env*"
  #   message: "Environment files contain secrets"
  #
  # Agent-specific protection examples (blocks specific subagents):
  # - pattern: "spectr/changes/**/tasks.jsonc"
  #   message: "Task files managed by orchestrator"
  #   agent: "coder"  # Only blocks coder subagent
  #
  # - pattern: "src/**/*.test.ts"
  #   message: "Test files managed by tester agent"
  #   agent: "code*"  # Blocks coder, coder-v2, etc.
  #
  # - pattern: "docs/**"
  #   agent: "*"  # Blocks all agents (same as omitting agent field)

  # Prevent editing git-ignored files
  preventUpdateGitIgnored: false

  # Tool usage rules
  toolUsageValidation: []
  # Example:
  # - tool: "Write"
  #   pattern: "**/*.js"
  #   action: "allow"
  # - tool: "Bash"
  #   commandPattern: "git push --force*"
  #   action: "block"
  #   message: "Force push not allowed"
  #
  # Agent-scoped rules (only apply to specific agents):
  # - tool: "Bash"
  #   pattern: ""
  #   commandPattern: "rm -rf *"
  #   action: "block"
  #   agent: "coder"
  #   message: "Coder agent cannot run destructive rm commands"
  # - tool: "Write"
  #   pattern: "**/*.test.ts"
  #   action: "block"
  #   agent: "coder"
  #   message: "Coder agent should not modify test files"
  # - tool: "*"
  #   pattern: "src/**"
  #   action: "block"
  #   agent: "test*"
  #   message: "Test agents cannot modify source files"
  #
  # Agent pattern examples:
  #   - agent: "coder"    # Exact match - only "coder" subagent
  #   - agent: "test*"    # Glob pattern - matches "tester", "test-runner"
  #   - agent: "*"        # Wildcard - matches all agents (default if omitted)

  # Directories where additions are prevented
  preventAdditions: []
  # Example: ["dist", "build"]

# System notifications
notifications:
  enabled: false
  hooks: []  # ["*"] for all, or ["Stop", "PreToolUse"]
  showErrors: false
  showSuccess: false
  showSystemEvents: true

# Permission request hook - auto-approve/deny tools
# Uncomment to enable:
#
# permissionRequest:
#   default: deny  # "allow" or "deny"
#   allow:
#     - "Read"
#     - "Glob"
#     - "Grep"
#     - "Edit"
#     - "Write"
#   deny:
#     - "BashOutput"
#     - "KillShell"

# User prompt submit hook - context injection and command execution
# Automatically prepends context when prompts match patterns
# Uncomment to enable:
#
# userPromptSubmit:
#   contextRules:
#     # Pattern-based context injection
#     - pattern: "sidebar"
#       prompt: |
#         Make sure to read @.claude/contexts/sidebar.md before proceeding.
#
#     # Multiple patterns with regex alternation
#     - pattern: "auth|login|authentication"
#       prompt: |
#         Review the authentication patterns in @.claude/contexts/auth.md
#
#     # Case-insensitive matching (using regex flag)
#     - pattern: "(?i)database|sql|query"
#       prompt: |
#         Follow the database conventions in @.claude/contexts/database.md
#
#     # Disable a rule temporarily
#     - pattern: "test"
#       prompt: "Run tests before proceeding"
#       enabled: false
#
#     # Explicit case-insensitive flag
#     - pattern: "api"
#       prompt: "Check API documentation first"
#       caseInsensitive: true
#
#   # Command execution (runs after contextRules processing)
#   # Commands are observational - they cannot block prompt processing
#   commands:
#     # Run for all prompts (no pattern)
#     - run: ".claude/scripts/log-prompt.sh"
#       showCommand: false
#
#     # Run only for prompts matching pattern (regex)
#     - pattern: "deploy|release|ship"
#       run: ".claude/scripts/notify-slack.sh"
#       showCommand: false
#
#     # Run with output display options
#     - pattern: "(?i)sql|database"
#       run: ".claude/scripts/check-db-access.sh"
#       showStdout: true
#       timeout: 30
#
#   # Environment variables available to commands:
#   # - CONCLAUDE_USER_PROMPT: The user's input text
#   # - CONCLAUDE_SESSION_ID: Current session ID
#   # - CONCLAUDE_CWD: Current working directory
#   # - CONCLAUDE_CONFIG_DIR: Directory containing .conclaude.yaml
#   # - CONCLAUDE_HOOK_EVENT: Always "UserPromptSubmit"
#
#   # Slash command hooks - trigger when users invoke /commands
#   # Commands CAN block prompt processing if they exit with code 2
#   slashCommands:
#     commands:
#       # Run when /commit is invoked
#       "/commit":
#         - run: ".claude/scripts/pre-commit-check.sh"
#           showStdout: true
#           message: "Commit blocked: validation failed"
#
#       # Run for any /test* command (e.g., /test, /test-unit)
#       "/test*":
#         - run: ".claude/scripts/test-setup.sh"
#           showCommand: false
#
#       # Run for all slash commands (wildcard)
#       "*":
#         - run: ".claude/scripts/log-slash-command.sh"
#           showCommand: false
#
#   # Environment variables available to slash command hooks:
#   # - CONCLAUDE_SLASH_COMMAND: The command name (e.g., "commit")
#   # - CONCLAUDE_SLASH_COMMAND_ARGS: Arguments passed to the command
#   # - CONCLAUDE_USER_PROMPT: Full prompt text
#   # - CONCLAUDE_SESSION_ID: Current session ID
#   # - CONCLAUDE_CWD: Current working directory
#   # - CONCLAUDE_HOOK_EVENT: Always "UserPromptSubmit"

# Skill start hook - runs when subagents (skills) start
# Uncomment to enable:
#
# skillStart:
#   commands:
#     # Run when "coder" skill starts
#     "coder":
#       - run: ".claude/scripts/coder-init.sh"
#         showStdout: true
#         message: "Coder environment initialized"
#
#     # Run for any skill starting with "test"
#     "test*":
#       - run: ".claude/scripts/test-env-check.sh"
#         showCommand: false
#
#     # Run for all skills (wildcard)
#     "*":
#       - run: ".claude/scripts/log-skill.sh"
#         showCommand: false
#
#   # Environment variables available to skill start hooks:
#   # - CONCLAUDE_SKILL_NAME: The skill/agent type name
#   # - CONCLAUDE_AGENT_ID: Unique agent identifier
#   # - CONCLAUDE_AGENT_TRANSCRIPT_PATH: Path to subagent's transcript
#   # - CONCLAUDE_SESSION_ID: Current session ID
#   # - CONCLAUDE_TRANSCRIPT_PATH: Main transcript file path
#   # - CONCLAUDE_HOOK_EVENT: Always "SubagentStart"
#   # - CONCLAUDE_CWD: Current working directory

# Teammate idle hook - runs when teammate agents become idle
# Exit code 2 from commands blocks the idle
# Uncomment to enable:
#
# teammateIdle:
#   commands:
#     # Run when "coder" teammate becomes idle
#     "coder":
#       - run: ".claude/scripts/check-coder-work.sh"
#         showStdout: true
#         message: "Coder has more work to do"
#
#     # Run for any teammate
#     "*":
#       - run: ".claude/scripts/log-teammate-idle.sh"
#         showCommand: false
#
#   # Environment variables available to teammate idle hooks:
#   # - CONCLAUDE_TEAMMATE_NAME: The teammate name
#   # - CONCLAUDE_TEAM_NAME: The team name
#   # - CONCLAUDE_SESSION_ID: Current session ID
#   # - CONCLAUDE_TRANSCRIPT_PATH: Main transcript file path
#   # - CONCLAUDE_HOOK_EVENT: Always "TeammateIdle"
#   # - CONCLAUDE_CWD: Current working directory

# Task completed hook - runs when tasks are completed
# Exit code 2 from commands blocks the completion
# Uncomment to enable:
#
# taskCompleted:
#   commands:
#     # Run for tasks matching "deploy*"
#     "deploy*":
#       - run: ".claude/scripts/verify-deploy.sh"
#         showStdout: true
#         message: "Deployment verification failed"
#
#     # Run for all completed tasks
#     "*":
#       - run: ".claude/scripts/log-task-complete.sh"
#         showCommand: false
#
#   # Environment variables available to task completed hooks:
#   # - CONCLAUDE_TASK_ID: The task identifier
#   # - CONCLAUDE_TASK_SUBJECT: The task subject/title
#   # - CONCLAUDE_TASK_DESCRIPTION: The task description (if available)
#   # - CONCLAUDE_SESSION_ID: Current session ID
#   # - CONCLAUDE_TRANSCRIPT_PATH: Main transcript file path
#   # - CONCLAUDE_HOOK_EVENT: Always "TaskCompleted"
#   # - CONCLAUDE_CWD: Current working directory

# Config change hook - runs when configuration changes
# Exit code 2 blocks the change (except policy_settings which cannot be blocked)
# Uncomment to enable:
#
# configChange:
#   commands:
#     # Audit all config changes
#     "*":
#       - run: ".claude/scripts/audit-config-change.sh"
#         showStdout: true
#
#     # Block user settings changes
#     "user_settings":
#       - run: ".claude/scripts/validate-user-settings.sh"
#         message: "User settings change blocked by validation"
#
#   # Environment variables available to config change hooks:
#   # - CONCLAUDE_CONFIG_SOURCE: The change source (user_settings, project_settings, local_settings, policy_settings, skills)
#   # - CONCLAUDE_CONFIG_FILE_PATH: Path to the changed file (if available)
#   # - CONCLAUDE_SESSION_ID: Current session ID
#   # - CONCLAUDE_TRANSCRIPT_PATH: Main transcript file path
#   # - CONCLAUDE_HOOK_EVENT: Always "ConfigChange"
#   # - CONCLAUDE_CWD: Current working directory

# Worktree create hook - custom worktree creation command
# The command must output the worktree path to stdout
# Uncomment to enable:
#
# worktreeCreate:
#   command: ".claude/scripts/create-worktree.sh"
#   timeout: 60
#
#   # Environment variables available:
#   # - CONCLAUDE_WORKTREE_NAME: The requested worktree name
#   # - CONCLAUDE_SESSION_ID: Current session ID
#   # - CONCLAUDE_CWD: Current working directory
#   # - CONCLAUDE_HOOK_EVENT: Always "WorktreeCreate"
